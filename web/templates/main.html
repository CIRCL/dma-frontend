<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>CIRCL - DMA - Dynamic Malware Analysis - upload interface</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

    <!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
    <!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
    <!--script src="js/less-1.3.3.min.js"></script-->
    <!--append ‘#!watch’ to the browser URL, then refresh the page. -->

    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="static/css/style.css" rel="stylesheet">
    <link href="static/css/tablecloth.css" rel="stylesheet">
    <link href="static/css/prettify.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="static/img/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="static/img/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="static/img/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="static/img/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="static/img/favicon.png">
    <script type="text/javascript" src="static/js/jquery.min.js"></script>
    <script type="text/javascript" src="static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/js/scripts.js"></script>
    <script type="text/javascript" src="static/js/bootstrap-select.js"></script>
    <script src="static/js/jquery.metadata.js"></script>
    <script src="static/js/jquery.tablesorter.min.js"></script>
    <script src="static/js/jquery.tablecloth.js"></script>

    <link href="static/css/bootstrap-select.css" rel="stylesheet">
        <script type="text/javascript">
            $(document).ready(function(e) {
                $('.selectpicker').selectpicker();
            });
        </script>
        <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {
                $("table").tablecloth({
                    sortable: true,
                    condensed: true,
                    striped: true,
                    bordered: true
                });
            });
    </script>
</head>

<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12">
            <div class="navbar">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a data-target=".navbar-responsive-collapse" data-toggle="collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a> <a href="https://www.circl.lu/dma/" class="brand"><img src="http://www.circl.lu/assets/images/logos/dma.png" class="img-rounded"/>(BETA v2)</a>
                        <div class="nav-collapse collapse navbar-responsive-collapse">
                            <ul class="nav pull-right">
                                <li> </li>
                                <li>Logged as <b>{{ auth.username }}</b></li>
                                <li class="divider-vertical"> </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="hero-unit">
                <p class="lead">
                   You can upload suspicious executable or documents to obtain a dynamic analysis. The documents or executables files are not shared with external parties. An analysis can take up to 15 minutes.
                </p>
            <div class="panel panel-primary panel-default">
                <div class="panel-heading">Malicious sample upload interface</div>
                <div class="panel-body">
                    <form role="form" method="POST" enctype="multipart/form-data" action="https://www.circl.lu/dma{{ url_for('upload') }}">
                        <div class="form-group">
                            <label class="col-lg-2 control-label">Sample (EXE, DLL or PDF) to submit</label>
                            <div class="col-lg-10">
                                <input type="file" name="sample" class="btn btn-info">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-lg-2 control-label">System to use</label>
                            <div class="col-lg-10">
                                <select class="form-control selectpicker" name="machine">
                                    {% for m in machines['machines'] %}
                                        {% if m['status'] != "aborted" %}
                                            <option value="{{ m['name'] }}"
                                                {% if m['status'] == "poweroff" %}
                                                    data-icon="icon-ok"
                                                {% elif m['status'] == "running" %}
                                                    data-icon="icon-repeat"
                                                {% endif %}
                                            data-subtext="{{ " / ".join(m['tags']) }}" >{{ m['name'] }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class"col-lg-2 control-label">Analysis package</label>
                        </div>
                        <div class="col-lg-10">
                            <select class="form-control selectpicker" name="package">
                                <option>applet</option>
                                <option>bin</option>
                                <option>dll</option>
                                <option>doc</option>
                                <option selected>exe</option>
                                <option>html</option>
                                <option>ie</option>
                                <option>jar</option>
                                <option>pdf</option>
                                <option>vbs</option>
                                <option>xls</option>
                                <option>zip</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-lg-offset-2 col-lg-10">
                            <button type="submit" class="btn btn-info">Submit for analysis</button>
                        </div>
                    </div>
                    </form>
                </div>
            </div>
        </div>
        {% if upload %}
            <div class="alert alert-success">
                Sample has been submitted {{ upload.filename }} as type {{ upload.mimetype }}
            </div>
        {% endif %}
    </div>
    {% if s %}
        <div class="hero-unit">
            <div class="panel panel-primary panel-default">
                <div class="panel-heading">Status of uploaded sample</div>
                <table class="table table-hover table-condensed btable tablehead">
                    <thead>
                        <tr><th>Task id</th><th>Sample</th><th>Status</th><th>Error(s)</th><th>System</th><th>Date</th></tr>
                    </thead>
                    {% for t in s %}
                        {% if t['task']['errors']|length > 0 %}
                            <tr class="error">
                        {% else %}
                            <tr class="success">
                        {% endif %}
                                <td>
                                {% if t['task']['status'] == 'reported' %}
                                    <a href="https://www.circl.lu/dma/rfetch/{{ t['task']['id'] }}">{{ t['task']['id'] }}</a>
                                {% else %}
                                    {{ t['task']['id'] }}
                                {% endif %}
                                </td>
                                <td>
                                    {{ t['task']['target'].split("/")[4] }}
                                </td>
                                <td>
                                    {{ t['task']['status'] }}
                                </td>
                                <td>
                                    {% if t['task']['errors']|length > 0 %}
                                        {{ t['task']['errors'][0] }}
                                    {% endif %}
                                </td>
                                <td>
                                    {{ t['task']['guest']['name'] }}
                                </td>
                                <td>
                                    {{ t['task']['completed_on'] }}
                                </td>
                            </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
    {% endif %}
</div>
</div>
</div>
</body>
</html>
